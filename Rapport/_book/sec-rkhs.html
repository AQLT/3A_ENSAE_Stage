<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 6 Filtres et Reproducing Kernel Hilbert Space (RKHS) | Détection en temps réels des points de retournement : apport de l’utilisation des filtres asymétriques dans l’analyse conjoncturelle</title>
  <meta name="description" content="Rapport de Stage de 3ème année d’Alain Quartier-la-Tente" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 6 Filtres et Reproducing Kernel Hilbert Space (RKHS) | Détection en temps réels des points de retournement : apport de l’utilisation des filtres asymétriques dans l’analyse conjoncturelle" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Rapport de Stage de 3ème année d’Alain Quartier-la-Tente" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 6 Filtres et Reproducing Kernel Hilbert Space (RKHS) | Détection en temps réels des points de retournement : apport de l’utilisation des filtres asymétriques dans l’analyse conjoncturelle" />
  
  <meta name="twitter:description" content="Rapport de Stage de 3ème année d’Alain Quartier-la-Tente" />
  

<meta name="author" content="Alain Quartier-la-Tente" />


<meta name="date" content="2021-11-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec-lppfilters.html"/>
<link rel="next" href="sec-comparison.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stage 3A AQLT</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Résumés</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="sec-SAtoTCE.html"><a href="sec-SAtoTCE.html"><i class="fa fa-check"></i><b>1</b> De la désaisonnalisation à l’estimation tendance-cycle</a></li>
<li class="chapter" data-level="2" data-path="sec-propMM.html"><a href="sec-propMM.html"><i class="fa fa-check"></i><b>2</b> Quelques propriétés sur les moyennes mobiles</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec-propMM.html"><a href="sec-propMM.html#gain-et-fonction-de-déphasage"><i class="fa fa-check"></i><b>2.1</b> Gain et fonction de déphasage</a></li>
<li class="chapter" data-level="2.2" data-path="sec-propMM.html"><a href="sec-propMM.html#propriétés-souhaitables-dune-moyenne-mobile"><i class="fa fa-check"></i><b>2.2</b> Propriétés souhaitables d’une moyenne mobile</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sec-propMM.html"><a href="sec-propMM.html#préservation-de-tendances"><i class="fa fa-check"></i><b>2.2.1</b> Préservation de tendances</a></li>
<li class="chapter" data-level="2.2.2" data-path="sec-propMM.html"><a href="sec-propMM.html#élimination-de-la-saisonnalité"><i class="fa fa-check"></i><b>2.2.2</b> Élimination de la saisonnalité</a></li>
<li class="chapter" data-level="2.2.3" data-path="sec-propMM.html"><a href="sec-propMM.html#réduction-du-bruit"><i class="fa fa-check"></i><b>2.2.3</b> Réduction du bruit</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sec-propMM.html"><a href="sec-propMM.html#sec-mmasym"><i class="fa fa-check"></i><b>2.3</b> Estimation en temps réel et moyennes mobiles asymétriques</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sec-propMM.html"><a href="sec-propMM.html#subec:mmetprev"><i class="fa fa-check"></i><b>2.3.1</b> Moyennes mobiles asymétriques et prévision</a></li>
<li class="chapter" data-level="2.3.2" data-path="sec-propMM.html"><a href="sec-propMM.html#indicateurs-de-qualité-des-moyennes-mobiles-asymétriques"><i class="fa fa-check"></i><b>2.3.2</b> Indicateurs de qualité des moyennes mobiles asymétriques</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sec-theoriegen.html"><a href="sec-theoriegen.html"><i class="fa fa-check"></i><b>3</b> D’une théorie générale sur la construction des filtres asymétriques à l’approche FST</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec-theoriegen.html"><a href="sec-theoriegen.html#subsec-theoriegen"><i class="fa fa-check"></i><b>3.1</b> Théorie générale de construction des filtres asymétriques</a></li>
<li class="chapter" data-level="3.2" data-path="sec-theoriegen.html"><a href="sec-theoriegen.html#subsec-GuggemosEtAl"><i class="fa fa-check"></i><b>3.2</b> Approche <em>Fidelity-Smoothness-Timeliness</em> (FST)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sec-WildiMcLeroy.html"><a href="sec-WildiMcLeroy.html"><i class="fa fa-check"></i><b>4</b> Filtres dépendant des données : trilemme ATS</a></li>
<li class="chapter" data-level="5" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html"><i class="fa fa-check"></i><b>5</b> Régression polynomiale locale</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#sec-proietti"><i class="fa fa-check"></i><b>5.1</b> Approche de Proietti et Luati</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#filtres-symétriques"><i class="fa fa-check"></i><b>5.1.1</b> Filtres symétriques</a></li>
<li class="chapter" data-level="5.1.2" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#sec-sympolyfilter"><i class="fa fa-check"></i><b>5.1.2</b> Quelques filtres symétriques particuliers</a></li>
<li class="chapter" data-level="5.1.3" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#filtres-asymétriques"><i class="fa fa-check"></i><b>5.1.3</b> Filtres asymétriques</a></li>
<li class="chapter" data-level="5.1.4" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#subsec-lppasymf"><i class="fa fa-check"></i><b>5.1.4</b> Classe générale</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#subsec-lptimeliness"><i class="fa fa-check"></i><b>5.2</b> Extension avec le critère de <em>timeliness</em></a></li>
<li class="chapter" data-level="5.3" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#subsec-graythomson"><i class="fa fa-check"></i><b>5.3</b> Gray et Thomson</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#filtres-symétriques-1"><i class="fa fa-check"></i><b>5.3.1</b> Filtres symétriques</a></li>
<li class="chapter" data-level="5.3.2" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#filtres-asymétriques-1"><i class="fa fa-check"></i><b>5.3.2</b> Filtres asymétriques</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#subsec-equivlpfst"><i class="fa fa-check"></i><b>5.4</b> Équivalence avec l’approche FST</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#liens-entre-les-critères-de-gray-et-thomson-et-ceux-de-grun-rehomme-et-alii"><i class="fa fa-check"></i><b>5.4.1</b> Liens entre les critères de Gray et Thomson et ceux de Grun-Rehomme <em>et alii</em></a></li>
<li class="chapter" data-level="5.4.2" data-path="sec-lppfilters.html"><a href="sec-lppfilters.html#équivalence-avec-les-moindres-carrés-pondérés"><i class="fa fa-check"></i><b>5.4.2</b> Équivalence avec les moindres carrés pondérés</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sec-rkhs.html"><a href="sec-rkhs.html"><i class="fa fa-check"></i><b>6</b> Filtres et Reproducing Kernel Hilbert Space (RKHS)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-rkhs.html"><a href="sec-rkhs.html#approche-de-dagum-et-bianconcini"><i class="fa fa-check"></i><b>6.1</b> Approche de Dagum et Bianconcini</a></li>
<li class="chapter" data-level="6.2" data-path="sec-rkhs.html"><a href="sec-rkhs.html#rkhs-et-polynômes-locaux"><i class="fa fa-check"></i><b>6.2</b> RKHS et polynômes locaux</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-comparison.html"><a href="sec-comparison.html"><i class="fa fa-check"></i><b>7</b> Comparaison des différentes méthodes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-comparison.html"><a href="sec-comparison.html#méthodologie"><i class="fa fa-check"></i><b>7.1</b> Méthodologie</a></li>
<li class="chapter" data-level="7.2" data-path="sec-comparison.html"><a href="sec-comparison.html#comparaison-des-filtres-polynomiaux-locaux-et-des-filtres-rkhs"><i class="fa fa-check"></i><b>7.2</b> Comparaison des filtres polynomiaux locaux et des filtres RKHS</a></li>
<li class="chapter" data-level="7.3" data-path="sec-comparison.html"><a href="sec-comparison.html#comparaison-avec-lapproche-fst"><i class="fa fa-check"></i><b>7.3</b> Comparaison avec l’approche FST</a></li>
<li class="chapter" data-level="7.4" data-path="sec-comparison.html"><a href="sec-comparison.html#impact-du-noyau"><i class="fa fa-check"></i><b>7.4</b> Impact du noyau</a></li>
<li class="chapter" data-level="7.5" data-path="sec-comparison.html"><a href="sec-comparison.html#discussion"><i class="fa fa-check"></i><b>7.5</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="appendix"><span><b>Annexe</b></span></li>
<li class="chapter" data-level="A" data-path="an-diag.html"><a href="an-diag.html"><i class="fa fa-check"></i><b>A</b> Synthèse des liens entre les différentes méthodes de construction de moyennes mobiles</a></li>
<li class="chapter" data-level="B" data-path="an-graphs.html"><a href="an-graphs.html"><i class="fa fa-check"></i><b>B</b> Coefficients, fonctions de gain et de déphasage</a></li>
<li class="chapter" data-level="C" data-path="an-equivfstlp.html"><a href="an-equivfstlp.html"><i class="fa fa-check"></i><b>C</b> Équivalence entre l’approche FST et les filtres polynomiaux locaux</a></li>
<li class="chapter" data-level="D" data-path="an-minrkhs.html"><a href="an-minrkhs.html"><i class="fa fa-check"></i><b>D</b> Critères de minimisation dans les filtres RKHS</a>
<ul>
<li class="chapter" data-level="D.1" data-path="an-minrkhs.html"><a href="an-minrkhs.html#filtre-symétrique-de-9-termes-h4"><i class="fa fa-check"></i><b>D.1</b> Filtre symétrique de 9 termes (<span class="math inline">\(h=4\)</span>)</a></li>
<li class="chapter" data-level="D.2" data-path="an-minrkhs.html"><a href="an-minrkhs.html#filtre-symétrique-de-13-termes-h6"><i class="fa fa-check"></i><b>D.2</b> Filtre symétrique de 13 termes (<span class="math inline">\(h=6\)</span>)</a></li>
<li class="chapter" data-level="D.3" data-path="an-minrkhs.html"><a href="an-minrkhs.html#filtre-symétrique-de-23-termes-h11"><i class="fa fa-check"></i><b>D.3</b> Filtre symétrique de 23 termes (<span class="math inline">\(h=11\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="sec-annexeFST.html"><a href="sec-annexeFST.html"><i class="fa fa-check"></i><b>E</b> Comparaison avec le filtre FST</a>
<ul>
<li class="chapter" data-level="E.1" data-path="sec-annexeFST.html"><a href="sec-annexeFST.html#filtres-polynomiaux-locaux"><i class="fa fa-check"></i><b>E.1</b> Filtres polynomiaux locaux</a></li>
<li class="chapter" data-level="E.2" data-path="sec-annexeFST.html"><a href="sec-annexeFST.html#filtres-rkhs"><i class="fa fa-check"></i><b>E.2</b> Filtres RKHS</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="an-x11.html"><a href="an-x11.html"><i class="fa fa-check"></i><b>F</b> Décomposition avec X-13ARIMA</a></li>
<li class="chapter" data-level="G" data-path="an-plotseries.html"><a href="an-plotseries.html"><i class="fa fa-check"></i><b>G</b> Exemples d’estimations de la tendance-cycle</a></li>
<li class="chapter" data-level="" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i>Références</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Détection en temps réels des points de retournement : apport de l’utilisation des filtres asymétriques dans l’analyse conjoncturelle</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!-- <script type="text/x-mathjax-config"> -->
    <!-- MathJax.Hub.Config({ -->
            <!--   TeX: { -->
                    <!--     Macros: { -->
                            <!--       NN: "{\\mathbb{N}}", -->
                            <!--       ZZ: "{\\mathbb{Z}}", -->
                            <!--       QQ: "{\\mathbb{Q}}", -->
                            <!--       RR: "{\\mathbb{R}}", -->
                            <!--       shiftset: "{\\mathcal{D}}", -->
                            <!--       dx: ["{\\mathrm{d}^{#1}\\mspace{-1mu}\\mathord{#2}}", 2, ""], -->
                            <!--       indic: "{\\unicode{x1D7D9}}", -->
                            <!--       prob: "\\mathop{\\mathbb{P}}", -->
                            <!--       esp: "\\mathop{\\mathbb{E}}", -->
                            <!--       var: "\\mathop{\\mathbb{V}\\text{ar}}", -->
                            <!--       cov: "\\mathop{\\mathbb{C}\\text{ov}}", -->
                            <!--       PP: ["{\\prob\\left({#1}\\right)}", 1], -->
                            <!--       EE: ["{\\esp\\left[{#1}\\right]}", 1], -->
                            <!--       VV: ["{\\var\\left[{#1}\\right]}", 1], -->
                            <!--       CC: ["{\\cov\\left[{#1}\\right]}", 1], -->
                            <!--       normal: ["{\\mathcal{N}\\left({#1},{#2}\\right)}", 2], -->
                            <!--       ou: ["{#1}_{\\text{ou}}", 1], -->
                            <!--       oui: ["{#1}_{\\text{ou},#2}", 2], -->
                            <!--       pv: "{\\mathfrak{p}}", -->
                            <!--       qv: "{\\mathfrak{q}}", -->
                            <!--       zs: "{\\mathfrak{z}}", -->
                            <!--       ts: "{\\mathfrak{t}}", -->
                            <!--       sign: "{\\mathfrak{s}}", -->
                            <!--       shifts: "{\\delta}", -->
                            <!--       optim: "{\\beta}", -->
                            <!--       param: "{\\theta}", -->
                            <!--       unif: ["{\\mathcal{U}\\left({#1}\\right)}", 1], -->
                            <!--       argmin: "\\mathop{\\mathrm{argmin}}", -->
                            <!--       diag: "\\mathop{\\mathrm{Diag}}", -->
                            <!--       rang: "\\mathop{\\mathrm{rang}}", -->
                            <!--       pa: "\\mathop{\\mathrm{pa}}", -->
                            <!--       mrca: "\\mathop{\\mathrm{mrca}}", -->
                            <!--       desc: "\\mathop{\\mathrm{desc}}", -->
                            <!--       warning: ["\\color{red}{{#1}}", 1] -->
                            <!--     } -->
                    <!--   } -->
            <!-- }); -->
    <!-- </script> -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    TeX: {Macros: {
            E: "{\\mathbb{E}}"
        },
        Augment: {
        Definitions: {
          delimiter: {
            "\\llbracket": '\u27E6',
            '\\rrbracket': '\u27E7'
          }}
        }}
    });
</script>
    <body>
    <div style="display:none" aria-hidden="true">
    \(
        \newcommand\R{\mathbb{R}}
        \newcommand\Z{\mathbb{Z}}
        \newcommand\LL{\mathbb{L}}
        \newcommand{\E}[1]{\mathbb{E}\left[#1\right]}
        \newcommand{\V}[1]{\mathbb{V}\left[#1\right]}
        \newcommand{\ps}[2]{\left\langle #1 \,,\, #2 \right\rangle}
        \newcommand\1{\mathbb{1}}
        \newcommand\N{\mathbb{N}}
        \newcommand\Norm{\mathcal{N}}
        \newcommand{\transp}[1]{{}^t\!#1}
        \newcommand\ud{\,\mathrm{d}}
        \DeclareMathOperator*{\argmax}{argmax}
        \DeclareMathOperator*{\argmin}{argmin}
        \DeclareMathOperator{\e}{e}
        \DeclareMathOperator{\Cov}{Cov}
        \DeclareMathOperator{\Determinant}{det}
        \newcommand{\determinant}[1]{\Determinant\left(#1\right)}
    \)
    </div>
    </body>
            
<div id="sec-rkhs" class="section level1" number="6">
<h1><span class="header-section-number">Chapitre 6</span> Filtres et Reproducing Kernel Hilbert Space (RKHS)</h1>
<div id="approche-de-dagum-et-bianconcini" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Approche de Dagum et Bianconcini</h2>
<p>La théorie des <em>Reproducing Kernel Hilbert Space</em> (RKHS) — espaces de Hilbert à noyau reproduisant — est une théorie générale dans l’apprentissage statistique non-paramétrique qui permet d’englober un grand nombre de méthodes.
C’est par exemple le cas des méthodes de régression par moindres carrés pénalisés, des Support Vector Machine (SVM), du filtre d’Hodrick-Prescott (utilisé pour décomposer tendance et cycle) ou encore des moyennes mobiles telles que celle d’Henderson.
Ainsi, <span class="citation"><a href="#ref-dagumbianconcini2008" role="doc-biblioref">Dagum et Bianconcini</a> (<a href="#ref-dagumbianconcini2008" role="doc-biblioref">2008</a>)</span> utilise la théorie des RKHS pour approcher le filtre d’Henderson et en dériver des filtres asymétriques associés.</p>
<p>Un RKHS <span class="math inline">\(\mathbb{L}^{2}(f_{0})\)</span> est un espace de Hilbert caractérisé par un noyau qui permet de reproduire toutes les fonctions de cet espace.
Il est caractérisé par une fonction de densité <span class="math inline">\(f_0\)</span> et un produit scalaire <span class="math inline">\(\ps{\cdot}{\cdot}\)</span> définit par :
<span class="math display">\[
\left\langle U(t),V(t)\right\rangle =\E{U(t)V(t)}=\int_{\R}U(t)V(t)f_{0}(t)\ud t\quad
\forall U,V\in\mathbb{L}^{2}(f_{0}).
\]</span>
La fonction <span class="math inline">\(f_0\)</span> pondère donc chaque valeur en fonction de sa position temporelle : il s’agit de la version continue des noyaux définis dans la partie <a href="sec-lppfilters.html#sec-kernels">5.1.1.1</a>.</p>
<p>Dans notre cas, on suppose que notre série initiale <span class="math inline">\(y_t\)</span> est désaisonnalisée et peut s’écrire comme la somme d’une tendance-cycle, <span class="math inline">\(TC_t\)</span>, et d’une composante irrégulière, <span class="math inline">\(I_t\)</span> (qui peut être un bruit blanc ou suivre un modèle ARIMA) :
<span class="math display">\[
y_t=TC_t+I_t.
\]</span>
La tendance-cycle peut être déterministe ou stochastique. On suppose que c’est une fonction régulière du temps, elle peut être localement approchée par un polynôme de degré <span class="math inline">\(d\)</span> :
<span class="math display">\[
TC_{t+j}=TC_t(j)=a_0+a_1j+\dots+a_dj^d+\varepsilon_{t+j},\quad
j\in\llbracket-h,h\rrbracket,
\]</span>
où <span class="math inline">\(\varepsilon_t\)</span> est un bruit blanc non corrélé à <span class="math inline">\(I_t\)</span>.</p>
<p>Les coefficients <span class="math inline">\(a_0,\dots,a_d\)</span> peuvent être estimés par projection des observations au voisinage de <span class="math inline">\(y_t\)</span> sur le sous-espace <span class="math inline">\(\mathbb P_d\)</span> des polynômes de degré <span class="math inline">\(d\)</span>, ou, de manière équivalente, par minimisation de la distance entre <span class="math inline">\(y_t\)</span> et <span class="math inline">\(TC_t(j)\)</span> :
<span class="math display" id="eq:mintcrkhs">\[\begin{equation}
\underset{TC\in\mathbb P_d}{\min}\lVert y -TC \rVert^2 = 
\underset{TC\in\mathbb P_d}{\min}\int_\R (y(t+s)-TC_t(s))^2f_0(s)\ud s.
\tag{6.1}
\end{equation}\]</span>
L’espace <span class="math inline">\(\mathbb P_d\)</span> étant un espace de Hilbert à dimension finie, il admet un noyau reproduisant (voir, par exemple, <span class="citation"><a href="#ref-berlinet2004" role="doc-biblioref">Berlinet et Thomas-Agnan</a> (<a href="#ref-berlinet2004" role="doc-biblioref">2004</a>)</span>).
Il existe ainsi une fonction <span class="math inline">\(R_d(\cdot,\cdot)\)</span> telle que :
<span class="math display">\[
\forall P\in \mathbb P_d: \forall t:
R_d(t,\cdot)\in\mathbb P_d\quad\text{et}\quad
P(t)=\ps{R_d(t,\cdot)}{P(\cdot)}.
\]</span></p>
<p>Le problème <a href="sec-rkhs.html#eq:mintcrkhs">(6.1)</a> admet une solution unique qui dépend d’une fonction <span class="math inline">\(K_{d+1}\)</span>, appelée <em>fonction de noyau</em> (<em>kernel function</em>).
Cette fonction est dite d’ordre <span class="math inline">\(d+1\)</span> car elle conserve les polynômes de degré <span class="math inline">\(d\)</span><a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a>.
Cette solution s’écrit :
<span class="math display" id="eq:rkhssoltc">\[\begin{equation}
\widehat{TC}(t)=\int_\R y(t-s)K_{d+1}(s) \ud s.
\tag{6.2}
\end{equation}\]</span>
Généralement <span class="math inline">\(f_0(t) = 0\)</span> pour <span class="math inline">\(\lvert t \rvert&gt;1\)</span>.
Cette solution s’écrit alors :
<span class="math display" id="eq:rkhssoltc2">\[\begin{equation}
\widehat{TC}(t)=\int_{[-1,1]} y(t-s)K_{d+1}(s) \ud s.
\tag{6.3}
\end{equation}\]</span>
On peut, par ailleurs, montrer que <span class="math inline">\(K_{d+1}\)</span> s’écrit en fonction <span class="math inline">\(f_0\)</span> et du noyau reproduisant <span class="math inline">\(K(\cdot,\cdot)\)</span> et que ce dernier peut s’écrire en fonction de polynômes <span class="math inline">\((P_i)_{i\in \llbracket 0, d-1 \rrbracket}\)</span> qui forme une base orthonormée de <span class="math inline">\(\mathbb L^2(f_0)\)</span> (voir par exemple <span class="citation"><a href="#ref-berlinet1993" role="doc-biblioref">Berlinet</a> (<a href="#ref-berlinet1993" role="doc-biblioref">1993</a>)</span>) :
<span class="math display">\[
K_{d+1}(t) = R_d(t,0)f_0(t) = \sum_{i=0}^dP_i(t)P_i(0)f_0(t).
\]</span></p>
<p>De plus, dans le cas discret, la solution <a href="sec-rkhs.html#eq:rkhssoltc2">(6.3)</a> s’écrit comme une somme pondérée au voisinage de <span class="math inline">\(y_t\)</span> :
<span class="math display" id="eq:rkhssym">\[\begin{equation}
\widehat{TC}_t=\sum_{j=-h}^h w_j y_{t+j}\quad
\text{où} \quad
w_j=\frac{K_{d+1}(j/b)}{\sum_{i=-h}^{^h}K_{d+1}(i/b)}.
\tag{6.4}
\end{equation}\]</span>
Le paramètre <span class="math inline">\(b\)</span> est choisi de sorte que les <span class="math inline">\(2h+1\)</span> points autour de <span class="math inline">\(y_t\)</span> soient utilisés avec un poids non nul.</p>
<p>Pour les filtres asymétriques, la formule <a href="sec-rkhs.html#eq:rkhssym">(6.4)</a> est simplement adaptée au nombre d’observations connues :
<span class="math display" id="eq:rkhsasym">\[\begin{equation}
\forall j\in\left\llbracket -h,q\right\rrbracket\::\: w_{a,j}=\frac{K_{d+1}(j/b)}{\sum_{i=-h}^{^q}K_{d+1}(i/b)}.
\tag{6.5}
\end{equation}\]</span>
En utilisant <span class="math inline">\(b=h+1\)</span> on retrouve les filtres symétriques obtenues par polynômes locaux.</p>
<p>Comme notamment montré par <span class="citation"><a href="#ref-dagumbianconcini2016seasonal" role="doc-biblioref">Dagum et Bianconcini</a> (<a href="#ref-dagumbianconcini2016seasonal" role="doc-biblioref">2016</a>)</span>, <span class="math inline">\(K_{d+1}\)</span> peut s’exprimer simplement à partir des moments de <span class="math inline">\(f_0\)</span><a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a>.
Ainsi, notons <span class="math inline">\(H_{d+1}\)</span> la matrice de Hankel associée aux moments de <span class="math inline">\(f_0\)</span> :
<span class="math display">\[
\forall i,j\in \llbracket 0, d\rrbracket:
\left(H_{d+1}\right)_{i,j}=\ps{X^i}{X^j}=\int s^{i+j}f_0(s)\ud s.
\]</span>
Notons également <span class="math inline">\(H_{d+1}[1,t]\)</span> la matrice obtenue en remplaçant la première ligne de <span class="math inline">\(H_{d+1}\)</span> par <span class="math inline">\(\begin{pmatrix} 1 &amp; t &amp; t^2 &amp; \dots &amp; t^d\end{pmatrix}\)</span>.
On a :
<span class="math display" id="eq:rkhskernelfun">\[\begin{equation}
K_{d+1}(t)=\frac{\det{H_{d+1}[1,t]}}{\det{H_{d+1}}}f_0(t).
\tag{6.6}
\end{equation}\]</span>
C’est cette formule qui est utilisée dans le package <code>rjdfilters</code> pour calculer les différentes moyennes mobiles.</p>
<p>Comme discuté dans la partie <a href="sec-lppfilters.html#sec-proietti">5.1</a>, le noyau d’Henderson dépend de la fenêtre utilisée.
Ainsi, tous les moments de l’équation <a href="sec-rkhs.html#eq:rkhskernelfun">(6.6)</a> doivent être recalculés pour chaque valeur de <span class="math inline">\(h\)</span>.
Pour éviter cela, <span class="citation"><a href="#ref-dagumbianconcini2008" role="doc-biblioref">Dagum et Bianconcini</a> (<a href="#ref-dagumbianconcini2008" role="doc-biblioref">2008</a>)</span> suggèrent d’utiliser le noyau quadratique (<em>biweight</em>) pour approcher le noyau d’Henderson lorsque <span class="math inline">\(h\)</span> est petit (<span class="math inline">\(h&lt; 24\)</span>) et le noyau cubique (<em>triweight</em>) lorsque <span class="math inline">\(h\)</span> est grand <span class="math inline">\(h\geq 24\)</span>.</p>
<p>Dans <span class="citation"><a href="#ref-dagumbianconcini2015new" role="doc-biblioref">Dagum et Bianconcini</a> (<a href="#ref-dagumbianconcini2015new" role="doc-biblioref">2015</a>)</span>, les auteures suggèrent de faire une sélection optimale du paramètre <span class="math inline">\(b\)</span>, par exemple en minimisant l’erreur quadratique moyenne (option <code>"frequencyresponse"</code> dans <code>rjdfilters::rkhs_filter</code>) :
<span class="math display">\[
b_{q,\gamma}=\underset{b_q\in[h; 3h]}{\min}
2\int_{0}^{\pi}
\lvert \Gamma_s(\omega)-\Gamma_\theta(\omega)\rvert^2\ud \omega.
\]</span>
Cela suppose en fait que la série entrée <span class="math inline">\(y_t\)</span> est un bruit blanc.
En supposant <span class="math inline">\(y_t\)</span> stationnaire, les critères définis dans l’article originel peuvent donc être étendus en multipliant les quantités sous les intégrales par la densité spectrale de <span class="math inline">\(y_t\)</span> notée <span class="math inline">\(h\)</span> :
<span class="math display">\[
b_{q,\gamma}=\underset{b_q\in[h; 3h]}{\min}
2\int_{0}^{\pi}
\lvert \Gamma_s(\omega)-\Gamma_\theta(\omega)\rvert^2h(\omega)\ud \omega.
\]</span>
Cette erreur quadratique moyenne peut également se décomposer en plusieurs termes (voir équation <a href="sec-WildiMcLeroy.html#eq:msedef">(4.1)</a> de la section <a href="sec-WildiMcLeroy.html#sec-WildiMcLeroy">4</a>) qui peuvent également être minimisés :</p>
<ul>
<li><p>l’<em>accuracy</em> qui correspond à la part de la révision liée aux différences de fonction de gain dans les fréquences liées à la tendance-cycle
<span class="math display">\[
b_{q,G}=\underset{b_q\in[h; 3h]}{\min}
2\int_{0}^{\omega_1}
\left(\rho_s(\omega)-\rho_\theta(\omega)\right)^{2} h(\omega)\ud \omega
\]</span></p></li>
<li><p>la <em>smoothness</em> qui correspond à la part de la révision liée aux différences de fonction de gain dans les fréquences liées aux résidus
<span class="math display">\[
b_{q,s}=\underset{b_q\in[h; 3h]}{\min}
2\int_{\omega_1}^{\pi}
\left(\rho_s(\omega)-\rho_\theta(\omega)\right)^{2} h(\omega)\ud \omega
\]</span></p></li>
<li><p>la <em>timeliness</em> qui correspond à la part de la révision liée au déphasage
<span class="math display">\[
b_{q,\varphi}=\underset{b_q\in[h; 3h]}{\min}
8\int_{0}^{\omega_1}
\rho_s(\lambda)\rho_\theta(\lambda)\sin^{2}\left(\frac{\varphi_\theta(\omega)}{2}\right)h(\omega)\ud \omega
\]</span>
Dans <code>rjdfilters</code> <span class="math inline">\(h\)</span> peut être fixée à la densité spectrale d’un bruit blanc (<span class="math inline">\(h_{WN}(x)=1\)</span>) ou d’une marche aléatoire (<span class="math inline">\(h_{RW}(x)=\frac{1}{2(1-\cos(x))}\)</span>).</p></li>
</ul>
<div class="remarque">
<p>Pour assurer une cohérence dans les définitions entre les différentes sections, les définitions de <span class="math inline">\(b_{q,G}\)</span>, <span class="math inline">\(b_{q,\gamma}\)</span> et <span class="math inline">\(b_{q,\varphi}\)</span> ont été légèrement modifiées par rapport à celles définies dans <span class="citation"><a href="#ref-dagumbianconcini2015new" role="doc-biblioref">Dagum et Bianconcini</a> (<a href="#ref-dagumbianconcini2015new" role="doc-biblioref">2015</a>)</span> où :</p>
<ul>
<li><p>dans <span class="math inline">\(b_{q,G}\)</span> le terme à minimiser est sous une racine carrée (sans impact sur le minimum) :
<span class="math display">\[
b_{q,G}=\underset{b_q}{\min}\sqrt{
2\int_{0}^{\pi}
\left(\rho_s(\omega)-\rho_\theta(\omega)\right)^{2}\ud \omega}
\]</span></p></li>
<li><p><span class="math inline">\(b_{q,s}\)</span> n’est pas considéré et <span class="math inline">\(b_{q,G}\)</span> est défini par <span class="math inline">\(\omega_1=\pi\)</span> et :
<span class="math display">\[
b_{q,G}=\underset{b_q\in[h; 3h]}{\min}
\sqrt{2\int_{0}^{\pi}
\left(\rho_s(\omega)-\rho_\theta(\omega)\right)^{2} \ud \omega}.
\]</span></p></li>
<li><p><span class="math inline">\(b_{q,\varphi}\)</span> est défini par :
<span class="math display">\[
b_{q,\varphi}=\underset{b_q}{\min}
\sqrt{2\int_{\Omega_S}
\rho_s(\lambda)\rho_\theta(\lambda)\sin^{2}\left(\frac{\varphi_\theta(\omega)}{2}\right)\ud \omega}
\]</span>
où <span class="math inline">\(\Omega_S=[0,2\pi/36]\)</span> est l’intervalle de fréquences associées aux cycles d’au moins 16 mois.</p></li>
<li><p>une formule différente est utilisée pour la fonction de réponse (<span class="math inline">\(\Gamma_\theta(\omega)=\sum_{k=-p}^{+f} \theta_k e^{2\pi i \omega k}\)</span>), ce qui conduit à des bornes d’intégrales légèrement différentes, sans effet sur le résultat.</p></li>
</ul>
</div>
<p>Un des inconvénients de cette méthode est qu’il n’y a pas unicité de la solution et donc qu’il y a parfois plusieurs extremum (voir annexe <a href="an-minrkhs.html#an-minrkhs">D</a>, graphiques <a href="an-minrkhs.html#fig:rkhstimeliness4wn">D.2</a>, <a href="an-minrkhs.html#fig:rkhstimeliness6wn">D.6</a> et <a href="an-minrkhs.html#fig:rkhstimeliness11wn">D.10</a> sur la <em>timeliness</em>).
Cela affecte uniquement les filtres qui minimisent la timeliness et uniquement pour certaines valeurs de <span class="math inline">\(q\)</span> (par exemple <span class="math inline">\(q=5\)</span> pour un filtre symétrique de 13 termes).
Comme notamment montré dans <span class="citation"><a href="#ref-JSM2021AQLTLQ" role="doc-biblioref">Quartier-la-Tente et Ladiray</a> (<a href="#ref-JSM2021AQLTLQ" role="doc-biblioref">2021</a>)</span>, la valeur optimal retenue par défaut par <code>rjdfilters</code> produit des discontinuités dans l’estimation de la tendance-cycle : dans les cas où il y a plusieurs extremum, il serait donc préférable de retenir celui pour lequel <span class="math inline">\(b\)</span> est maximal.
C’est ce qui a été retenu dans la suite de ce rapport, c’est également cohérent avec les valeurs optimales présentés dans <span class="citation"><a href="#ref-dagumbianconcini2015new" role="doc-biblioref">Dagum et Bianconcini</a> (<a href="#ref-dagumbianconcini2015new" role="doc-biblioref">2015</a>)</span>.</p>
<!-- The table \@ref(tab:criteriarkhs) shows the quality criteria of the RKHS filters. -->
<!-- Even if the symmetric filter preserves quadratic trends, this is not the case of the asymmetric filters: they only preserve constant trends. -->
<!-- The more data is available (i.e.: $q$ increases), the less the asymmetric filters distort polynomial trends (for example, for $q=2$, $b_l\simeq0$ for $b_{q,G}$). -->
<!-- ```{r criteriarkhs, echo = FALSE} -->
<!-- library(kableExtra) -->
<!-- rkhs_diagnostics <- readRDS("data/rkhs_diagnostics.RDS") -->
<!-- title <- "Critères de qualité de qualité des filtres asymétriques ($q=0,1,2$) calculés à partir des RKHS pour $h=6$." -->
<!-- colnames(rkhs_diagnostics) <- gsub(" ?\\$ ?","$",colnames(rkhs_diagnostics)) -->
<!-- rkhs_diagnostics[,1] <- gsub(" ?\\$ ?","$",rkhs_diagnostics[,1]) -->
<!-- groupement <- table(rkhs_diagnostics[,1]) -->
<!-- rkhs_diagnostics[,-1] %>%  -->
<!--   kable(format.args = list(digits = 3), align = "c", booktabs = T, row.names = FALSE, -->
<!--         escape = FALSE,caption = title) %>%  -->
<!--   kable_styling(latex_options=c(#"striped",  -->
<!--                                 "scale_down", "hold_position")) %>% -->
<!--   pack_rows(index = groupement, escape = FALSE) -->
<!-- ``` -->
<div class="summary_box">
<div id="testrkhs" class="title">
<p>RKHS filters - <span class="citation"><a href="#ref-dagumbianconcini2008" role="doc-biblioref">Dagum et Bianconcini</a> (<a href="#ref-dagumbianconcini2008" role="doc-biblioref">2008</a>)</span></p>
</div>
<p><strong>Avantages</strong> :</p>
<ul>
<li><p>Le filtre asymétrique est indépendant des données et de la date d’estimation.</p></li>
<li><p>La méthode est généralisable à des séries avec des fréquences irrégulières (par exemple avec beaucoup de valeurs manquantes).</p></li>
</ul>
<p><strong>Inconvénient</strong> :</p>
<ul>
<li>Il peut y avoir des problèmes de minimisation (notamment en minimisant la <em>timeliness</em>).</li>
</ul>
</div>
<p>Tous les critères utilisés de la sélection optimale du paramètre <span class="math inline">\(b\)</span> pouvant s’écrire comme cas particuliers du critère <span class="math inline">\(J\)</span> défini dans l’équation <a href="sec-theoriegen.html#eq:theoriegen1">(3.1)</a> (voir section <a href="sec-WildiMcLeroy.html#sec-WildiMcLeroy">4</a>), cette méthode s’inscrit dans le cadre de la théorie générale définie dans la section <a href="sec-theoriegen.html#subsec-theoriegen">3.1</a> en imposant comme contrainte linéaire que les coefficients soient sous la forme <span class="math inline">\(w_j=\frac{K_{d+1}(j/b)}{\sum_{i=-h}^{^p}K_{d+1}(i/b)}\)</span>.</p>
</div>
<div id="rkhs-et-polynômes-locaux" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> RKHS et polynômes locaux</h2>
<p>Comme montré dans la section précédente, la théorie des espaces de Hilbert à noyau reproduisant permet de reproduire les filtres symétriques par approximation polynomiale locale.
Comme le montrent <span class="citation"><a href="#ref-LuatiProietti2011" role="doc-biblioref">Luati et Proietti</a> (<a href="#ref-LuatiProietti2011" role="doc-biblioref">2011</a>)</span>, cette théorie permet donc également de reproduire les filtres directs asymétriques (DAF), qui sont équivalents à l’approximation polynomiale locale mais en utilisant une fenêtre d’estimation asymétrique.
Cependant, ils ne peuvent pas être obtenus par la formalisation de <span class="citation"><a href="#ref-dagumbianconcini2008" role="doc-biblioref">Dagum et Bianconcini</a> (<a href="#ref-dagumbianconcini2008" role="doc-biblioref">2008</a>)</span> mais par une discrétisation différente de la formule <a href="sec-rkhs.html#eq:rkhskernelfun">(6.6)</a> :
<span class="math display">\[
K_{d+1}(t)=\frac{\det{H_{d+1}[1,t]}}{\det{H_{d+1}}}f_0(t).
\]</span>
Dans le cas discret, <span class="math inline">\(f_0(t)\)</span> est remplacé par <span class="math inline">\(\kappa_j\)</span> et en remplaçant les moments théoriques par les moments empiriques <span class="math inline">\(H_{d+1}\)</span> devient <span class="math inline">\(X&#39;_pK_pX_p\)</span> et les coefficients du filtre asymétrique sont obtenus en utilisant la formule :
<span class="math display">\[
w_{a,j}=\frac{\det{X&#39;_pK_pX_p[1,j]}
}{
\det{X&#39;_pK_pX_p}
}\kappa_j.
\]</span>
En effet, la règle de Cramer permet de trouver une solution explicite à l’équation des moindres carrés <span class="math inline">\((X&#39;_pK_pX_p)\hat \beta=X&#39;_pK_py_p\)</span> où <span class="math inline">\(\hat \beta_0=\hat m_t\)</span> :
<span class="math display">\[
\hat \beta_0 = \frac{\det{X&#39;_pK_pX_p[1,b]}}{\det{X&#39;_pK_pX_p}}f_0(t)
\quad\text{où}\quad b=X&#39;_pK_py_p.
\]</span>
Comme <span class="math inline">\(b=\sum_{j=-h}^qx_j\kappa_jy_{t+j}\)</span> il vient :
<span class="math display">\[
\det{X&#39;_pK_pX_p[1,b]} = \sum_{j=-h}^q\det{X&#39;_pK_pX_p[1,x_j]}\kappa_jy_{t+j}.
\]</span>
Et enfin :
<span class="math display">\[
\hat \beta_0 = \hat m_t= \sum_{j=-h}^q\frac{\det{X&#39;_pK_pX_p[1,j]}
}{
\det{X&#39;_pK_pX_p}
}\kappa_j y_{t+j}.
\]</span></p>

</div>
</div>
<h3>Références</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-berlinet1993" class="csl-entry">
Berlinet, Alain. 1993. <span>« Hierarchies of higher order kernels »</span>. <em>Probability Theory and Related Fields</em> 94: 489‑504.
</div>
<div id="ref-berlinet2004" class="csl-entry">
Berlinet, Alain, et Christine Thomas-Agnan. 2004. <em>Reproducing Kernel Hilbert Spaces in Probability and Statistics</em>. Springer.
</div>
<div id="ref-dagumbianconcini2008" class="csl-entry">
Dagum, Estela Bee, et Silvia Bianconcini. 2008. <span>« <span>The Henderson Smoother in Reproducing Kernel Hilbert Space</span> »</span>. <em>Journal of Business &amp; Economic Statistics</em> 26: 536‑45. <a href="https://ideas.repec.org/a/bes/jnlbes/v26y2008p536-545.html">https://ideas.repec.org/a/bes/jnlbes/v26y2008p536-545.html</a>.
</div>
<div id="ref-dagumbianconcini2015new" class="csl-entry">
———. 2015. <span>« <span>A new set of asymmetric filters for tracking the short-term trend in real-time</span> »</span>. <em>The Annals of Applied Statistics</em> 9 (3): 1433‑58. <a href="https://doi.org/&quot;10.1214/15-AOAS856&quot;">https://doi.org/"10.1214/15-AOAS856"</a>.
</div>
<div id="ref-dagumbianconcini2016seasonal" class="csl-entry">
———. 2016. <em>Seasonal adjustment methods and real time trend-cycle estimation</em>. Springer.
</div>
<div id="ref-LuatiProietti2011" class="csl-entry">
Luati, Alessandra, et Tommaso Proietti. 2011. <span>« On the equivalence of the weighted least squares and the generalised least squares estimators, with applications to kernel smoothing »</span>. <em>Annals of the Institute of Statistical Mathematics</em> 63 (4): 851‑71. <a href="https://doi.org/10.1007/s10463-009-0267-8">https://doi.org/10.1007/s10463-009-0267-8</a>.
</div>
<div id="ref-JSM2021AQLTLQ" class="csl-entry">
Quartier-la-Tente, Alain, et Dominique Ladiray. 2021. <span>« Asymmetric Linear Filters for Seasonal <span>Adjustment: Applications</span> to the COVID-19 Impact in Monthly Time Series »</span>. In <em>Joint Statistical Meetings (JSM)</em>. <a href="https://ww2.amstat.org/meetings/jsm/2021/onlineprogram/AbstractDetails.cfm?abstractid=317462">https://ww2.amstat.org/meetings/jsm/2021/onlineprogram/AbstractDetails.cfm?abstractid=317462</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="19">
<li id="fn19"><p>
C’est-à-dire <span class="math inline">\(\int_\R K_{d+1}(s)\ud s = 1\)</span> et <span class="math inline">\(\int_\R K_{d+1}(s) s^i\ud s = 1\)</span> pour <span class="math inline">\(i\in \llbracket 1, d\rrbracket\)</span>.<a href="sec-rkhs.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>
Cela vient en fait du procédé d’orthonomalisation de Gram-Schmidt.<a href="sec-rkhs.html#fnref20" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-lppfilters.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-comparison.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Stage_3A.pdf", "Stage_3A.docx", "Stage_3A.tex"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
