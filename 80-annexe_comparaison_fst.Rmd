# (APPENDIX) Annexe {-} 
# Comparaison avec le filtre FST

Cette annexe synthétise les cas où il est possible de trouver un ensemble de poids tels que les filtres FST ont de meilleurs propriété (en termes de *fidelity*, *smoothness* et *timeliness*) que les filtres polynomiaux ou RKHS avec les mêmes contraintes sur la préservation des polynômes (ou des contraintes supérieures).

```{r, include = FALSE}
note <- c("La zone grisée corresponds à l'ensemble $\\left\\{\\begin{pmatrix}x & y & z \\end{pmatrix}' : x+y+z=1\\right\\}$.",
          "Le graphique est vide lorsque aucun poids ne permet de trouver de filtre FST qui minimise la \\emph{fidelity}, \\emph{smoothness} et la \\emph{timelisse} par rapport au filtre étudié.")
```


## Filtres polynomiaux locaux

```{r lc6d0ic35, fig.cap = "Ensemble des poids pour lesquels la méthode FST donne des filtres de meilleurs qualité que le filtre *Linear-Constant* (LC) sous contrainte de préservation des constantes et pour $h=6$, $I/C=3,5$.", fig.note = note, cache = TRUE}
data = readRDS(sprintf("data/comparaison_fst/comparison_fst_weights_h%s_ic%.1f.RDS", 6, 3.5))
par(mfrow = c(2,3), 
    mar = 0 + c(1, 0, 1, 0),
    mai = c(0.2, 0.2, 0.2, 0.2))
for(q in 0:5){
    titre <- sprintf("q = %i", q)
    global_plot(data, q = q, method = "LC", degree = 0, theta = 150,
                titre = titre)
}
```


```{r lc6d1ic35, fig.cap = "Ensemble des poids pour lesquels la méthode FST donne des filtres de meilleurs qualité que le filtre *Linear-Constant* (LC) sous contrainte de préservation des droites et pour $h=6$, $I/C=3,5$.", fig.note = note, cache = TRUE}
par(mfrow = c(2,3), 
    mar = 0 + c(1, 0, 1, 0),
    mai = c(0.2, 0.2, 0.2, 0.2))
for(q in 0:5){
    titre <- sprintf("q = %i", q)
    global_plot(data, q = q, method = "LC", degree = 1, theta = 150,
                titre = titre)
}
```



```{r lc11d0ic35, fig.cap = "Ensemble des poids pour lesquels la méthode FST donne des filtres de meilleurs qualité que le filtre *Linear-Constant* (LC) sous contrainte de préservation des constantes et pour $h=11$, $I/C=3,5$.", fig.note = note, cache = TRUE, fig.height=10}
data = readRDS(sprintf("data/comparaison_fst/comparison_fst_weights_h%s_ic%.1f.RDS", 11, 3.5))
par(mfrow = c(4,3), 
    mar = 0 + c(1, 0, 1, 0),
    mai = c(0.2, 0.2, 0.2, 0.2))
for(q in 0:11){
    titre <- sprintf("q = %i", q)
    global_plot(data, q = q, method = "LC", degree = 0, theta = 150,
                titre = titre)
}
```


```{r lc11d1ic35, fig.cap = "Ensemble des poids pour lesquels la méthode FST donne des filtres de meilleurs qualité que le filtre *Linear-Constant* (LC) sous contrainte de préservation des droites et pour $h=11$, $I/C=3,5$.", fig.note = note, cache = TRUE, fig.height=10}
par(mfrow = c(4,3), 
    mar = 0 + c(1, 0, 1, 0),
    mai = c(0.2, 0.2, 0.2, 0.2))
for(q in 0:11){
    titre <- sprintf("q = %i", q)
    global_plot(data, q = q, method = "LC", degree = 1, theta = 150,
                titre = titre)
}
```


## Filtres RKHS

```{r rkhs6d0, fig.cap = "Ensemble des poids pour lesquels la méthode FST donne des filtres de meilleurs qualité que le filtre $b_{q,\\varphi}$ sous contrainte de préservation des constantes et pour $h=6$.", fig.note = note, cache = TRUE}
data = readRDS(sprintf("data/comparaison_fst/comparison_fst_weights_h%s_ic%.1f.RDS", 6, 3.5))
par(mfrow = c(2,3), 
    mar = 0 + c(1, 0, 1, 0),
    mai = c(0.2, 0.2, 0.2, 0.2))
for(q in 0:5){
    titre <- sprintf("q = %i", q)
    global_plot(data, q = q, method = "phase", degree = 0, theta = 150,
                titre = titre)
}
```


```{r rkhs6d1, fig.cap = "Ensemble des poids pour lesquels la méthode FST donne des filtres de meilleurs qualité que le filtre $b_{q,\\varphi}$ sous contrainte de préservation des droites et pour $h=6$.", fig.note = note, cache = TRUE}
par(mfrow = c(2,3), 
    mar = 0 + c(1, 0, 1, 0),
    mai = c(0.2, 0.2, 0.2, 0.2))
for(q in 0:5){
    titre <- sprintf("q = %i", q)
    global_plot(data, q = q, method = "phase", degree = 1, theta = 150,
                titre = titre)
}
```



```{r rkhs6d2, fig.cap = "Ensemble des poids pour lesquels la méthode FST donne des filtres de meilleurs qualité que le filtre $b_{q,\\varphi}$ sous contrainte de préservation des tendances quadratiques et pour $h=6$.", fig.note = note, cache = TRUE}
data = readRDS(sprintf("data/comparaison_fst/comparison_fst_weights_h%s_ic%.1f.RDS", 11, 3.5))
par(mfrow = c(2,3), 
    mar = 0 + c(1, 0, 1, 0),
    mai = c(0.2, 0.2, 0.2, 0.2))
for(q in 0:5){
    titre <- sprintf("q = %i", q)
    global_plot(data, q = q, method = "phase", degree = 2, theta = 150,
                titre = titre)
}
```




```{r rkhs11d0, fig.cap = "Ensemble des poids pour lesquels la méthode FST donne des filtres de meilleurs qualité que le filtre $b_{q,\\varphi}$ sous contrainte de préservation des constantes et pour $h=11$.", fig.note = note, cache = TRUE, fig.height=10}
data = readRDS(sprintf("data/comparaison_fst/comparison_fst_weights_h%s_ic%.1f.RDS", 11, 3.5))
par(mfrow = c(4,3), 
    mar = 0 + c(1, 0, 1, 0),
    mai = c(0.2, 0.2, 0.2, 0.2))
for(q in 0:11){
    titre <- sprintf("q = %i", q)
    global_plot(data, q = q, method = "phase", degree = 0, theta = 150,
                titre = titre)
}
```


```{r rkhs11d1, fig.cap = "Ensemble des poids pour lesquels la méthode FST donne des filtres de meilleurs qualité que le filtre $b_{q,\\varphi}$ sous contrainte de préservation des droites et pour $h=11$.", fig.note = note, cache = TRUE, fig.height=10}
par(mfrow = c(4,3), 
    mar = 0 + c(1, 0, 1, 0),
    mai = c(0.2, 0.2, 0.2, 0.2))
for(q in 0:11){
    titre <- sprintf("q = %i", q)
    global_plot(data, q = q, method = "phase", degree = 1, theta = 150,
                titre = titre)
}
```



```{r rkhs11d2, fig.cap = "Ensemble des poids pour lesquels la méthode FST donne des filtres de meilleurs qualité que le filtre $b_{q,\\varphi}$ sous contrainte de préservation des tendances quadratiques et pour $h=11$.", fig.note = note, cache = TRUE, fig.height=10}
data = readRDS(sprintf("data/comparaison_fst/comparison_fst_weights_h%s_ic%.1f.RDS", 11, 3.5))
par(mfrow = c(4,3), 
    mar = 0 + c(1, 0, 1, 0),
    mai = c(0.2, 0.2, 0.2, 0.2))
for(q in 0:11){
    titre <- sprintf("q = %i", q)
    global_plot(data, q = q, method = "phase", degree = 2, theta = 150,
                titre = titre)
}
```



