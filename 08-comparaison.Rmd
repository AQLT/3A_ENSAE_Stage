# Comparison des différentes méthodes {#sec:comparison}

## Méthodologie

Dans cette section, on compare les différentes moyennes mobiles en termes de délai pour détecter les points de retournement.
Dans ce rapport on définit de la façon suivante les points de retournement en distinguant deux cas :

- les redressements (*upturn*) où l'on passe d'une phase de récession à une phase d'expansion de l'économie (comme généralement le cas après une crise économique). 
C'est le cas lorsqu'à la date $t$ $y_{t-k}\geq\cdots\geq y_{t-1}<y_t\leq y_{t+1}\leq\cdots y_{t+m}$.

- les ralentissements (*downturn*) où l'on passe d'une phase d'expansion à une phase de récession.
C'est le cas lorsqu'à la date $t$ $y_{t-k}\leq\cdots\leq y_{t-1}>y_t\geq y_{t+1}\geq\cdots y_{t+m}$.

En suivant @Zellner1991, du fait du caractère relativement lisse de la tendance-cycle, on retient les paramètres $k=3$ and $m=1$. 

On compare la performance des différents filtres sur la base d'Eurostat des indices de production industriels déjà corrigés des jours ouvrables (`sts_inpr_m`, 2 404 séries).
Les points de retournement finaux sont ceux qui sont trouvés sur la composante tendance-cycle estimée avec la méthode X-13ARIMA sur l'ensemble de la période.
Le déphasage est défini comme le nombre de mois nécessaires pour détecter le bon point de retournement sans aucune révision future (il est donc possible que ce déphasage ne soit pas calculable si pour une méthode donnée on ne détecte pas le bon point de retournement à la dernière date d'estimation).

Pour chaque série et chaque date, la méthodologie suivante est utilisée :

1. La série est désaisonnalisée avec la méthode X-13ARIMA^[
On utilise pour cela la fonction `x13()` du package `RJDemetra` avec le paramètre `spec = "RSA3"` (détection automatique des différents paramètres sans correction des jours ouvrables).
] pour extraire différents paramètres qui seront fixés entre les différentes méthodologie : la série linéarisée (i.e. : la série initiale corrigée de points atypiques par un Reg-ARIMA), la longueur des filtres saisonniers et du filtre utilisé pour extraire la tendance-cycle, le schéma de décomposition et l'I-C ratio.

2. Une nouvelle désaisonnalisation est effectuée sur la série linéarisée en utilisant l'algorithme de décomposition de X-13ARIMA et en utilisant les mêmes paramètres que précédemment et en changement uniquement les filtres asymétriques utilisés pour extraire la tendance-cycle^[
Cela peut être fait en utilisant la fonction `rjdfilters::x11()`.
].  
Pour contrôler l'impact des estimations des paramètres et des points atypiques dans le modèle Reg-ARIMA model, la série linéarisée utilisée ici correspond à celle calculée sur l'ensemble de la série.  
Pour la méthode de référence (X-13ARIMA), la série linéarisée est prolongée par prévision sur un an avant la décomposition mais pour toutes les autres méthodes on n'utilise pas les prévisions dans la décomposition.
Une description plus détaillée de l'algorithme de décomposition est disponible en annexe \@ref(an:x11).

3. Pour chaque estimation de la tendance-cycle, on calcule les points de redressement et de ralentissement.



## Comparaison des filtres polynomiaux locaux et des filtres RKHS

Du fait du fort degré de liberté de l'approche FST (dans le choix des différents paramètres), dans cette section, on ne compare la méthode X-13ARIMA qu'à l'approche polynomiale locale et aux filtres RKHS.
Pour les filtres RKHS on ne retient que ceux qui minimisent la *timeliness* puisque dans notre cas on souhaite minimiser le délai dans la détection de point de retournement.


## Comparaison avec l'approche FST

Pour limiter les degrés de liberté dans le choix des poids dans l'approche FST, une approche peut être de les sélectionner comparativement à une autre moyenne mobile.
En effet, si l'on se concentre sur les trois critères de *fidelity*, *smoothness* et *timeliness*, comparativement à une moyenne mobile fixée, un ensemble de poids peut être considéré comme optimal s'il conduit à un filtre de meilleure qualité (selon ces trois critères) avec les mêmes contraintes polynomiales (ou des contraintes polynomiales plus grandes).
L'annexe \@ref(sec:annexeFST) trace l'ensemble de ces poids pour les filtres locaux polynomiaux et les filtres RKHS mais synthétisons ici les résultats pour $h=6$ (filtre symétrique de 13 termes).


<!-- For $h=6$ (13-term symmetric filter), for the RKHS filters we find that: -->

<!-- - imposing that asymmetric filters preserve constants, the FST approach gives better results for all values of $q$ for the filters computed with $b_{q,G}$ and $b_{q,\gamma}$, and for $q\leq 3$ for the one computed with $b_{q,\varphi}$. -->

<!-- - imposing that asymmetric filters preserve linear trends, the FST approach gives better results for $q\in[2,5]$ for the filters computed with $b_{q,G}$ and $b_{q,\gamma}$, and for $q\in[2,4]$ for the one computed with $b_{q,\varphi}$. -->

<!-- `r fa_arrow_circle_right` Therefore, the RKHS approach seems not to be the better approach to build asymmetric filters to apply to monthly regular data (i.e.: data for which we usually use $h=6$). -->

<!-- For the local polynomial filters we find that: -->

<!-- - imposing that asymmetric filters preserve constants, the FST approach gives better results than the LC method for all values of $q$.  -->
<!-- Adding the timeliness criterion allows to have better results than the FST approach for $q=0,1$. -->

<!-- - imposing that asymmetric filters preserve linear trends, the FST approach gives better results for $q\in[2,5]$ for the LC and QL methods.  -->
<!-- Adding the timeliness criterion doesn't change the results. -->

<!-- `r fa_arrow_circle_right` In terms of quality criteria, local polynomial seems to perform better for real-time and one-period ahead filters ($q=0,1$). -->

<!-- Those comparisons can be seen in an online application available at https://aqlt.shinyapps.io/FSTfilters/. -->


Moreover, this example also illustrates that the different methods perform better than the DAF filters. 
The real-time estimates methods that use this filter could be easily improved.
This is for example the case of STL (Seasonal-Trend decomposition based on Loess) seasonal adjustment method proposed by @cleveland90.

\newpage
